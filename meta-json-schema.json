{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://github.com/MetaCubeX/meta-json-schema/schema/meta-json-schema.json",
  "type": "object",
  "title": "Clash.Meta Config Schema",
  "additionalProperties": true,
  "definitions": {
    "types": {
      "stringArray": {
        "oneOf": [
          {"type": "array", "items": {"type": "string"}},
          {"type": "string"}
        ]
      },
      "ipv4Array": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/ipv4"}},
          {"$ref": "#/definitions/patterns/ipv4"}
        ]
      },
      "ipv4PortArray": {
        "oneOf": [
          {
            "type": "array",
            "items": {"$ref": "#/definitions/patterns/ipv4Port"}
          },
          {"$ref": "#/definitions/patterns/ipv4Port"}
        ]
      },
      "ipv4CIDRArray": {
        "oneOf": [
          {
            "type": "array",
            "items": {"$ref": "#/definitions/patterns/ipv4CIDR"}
          },
          {"$ref": "#/definitions/patterns/ipv4CIDR"}
        ]
      },
      "ipv6Array": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/ipv6"}},
          {"$ref": "#/definitions/patterns/ipv6"}
        ]
      },
      "ipv6PortArray": {
        "oneOf": [
          {
            "type": "array",
            "items": {"$ref": "#/definitions/patterns/ipv6Port"}
          },
          {"$ref": "#/definitions/patterns/ipv6Port"}
        ]
      },
      "ipv6CIDRArray": {
        "oneOf": [
          {
            "type": "array",
            "items": {"$ref": "#/definitions/patterns/ipv6CIDR"}
          },
          {"$ref": "#/definitions/patterns/ipv6CIDR"}
        ]
      },
      "ipArray": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/ip"}},
          {"$ref": "#/definitions/patterns/ip"}
        ]
      },
      "ipPortArray": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/ipPort"}},
          {"$ref": "#/definitions/patterns/ipPort"}
        ]
      },
      "ipCIDRArray": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/ipCIDR"}},
          {"$ref": "#/definitions/patterns/ipCIDR"}
        ]
      },
      "serverArray": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/server"}},
          {"$ref": "#/definitions/patterns/server"}
        ]
      },
      "domainArray": {
        "oneOf": [
          {"type": "array", "items": {"$ref": "#/definitions/patterns/domain"}},
          {"$ref": "#/definitions/patterns/domain"}
        ]
      }
    },
    "patterns": {
      "port": {
        "pattern": "^(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5])$",
        "errorMessage": "无效的端口号(0~65535)"
      },
      "ipv4": {
        "type": "string",
        "pattern": "^(?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))$",
        "errorMessage": "无效的IPv4地址"
      },
      "ipv4Port": {
        "type": "string",
        "pattern": "^(?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5])):(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5])$",
        "errorMessage": "无效的IPv4地址:端口"
      },
      "ipv4CIDR": {
        "type": "string",
        "pattern": "^(?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))(?:\\/(?:[12]?[0-9]|3[0-2]))$",
        "errorMessage": "无效的IPv4网段"
      },
      "ipv6": {
        "type": "string",
        "pattern": "^(?:(?:(?:[A-F0-9]{1,4}:){6}|(?=(?:[A-F0-9]{0,4}:){0,6}(?:[0-9]{1,3}\\.){3}[0-9]{1,3}(?![:.\\w]))(([0-9A-F]{1,4}:){0,5}|:)((:[0-9A-F]{1,4}){1,5}:|:)|::(?:[A-F0-9]{1,4}:){5})(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}|(?=(?:[A-F0-9]{0,4}:){0,7}[A-F0-9]{0,4}(?![:.\\w]))(([0-9A-F]{1,4}:){1,7}|:)((:[0-9A-F]{1,4}){1,7}|:)|(?:[A-F0-9]{1,4}:){7}:|:(:[A-F0-9]{1,4}){7})(?![:.\\w])$",
        "errorMessage": "无效的IPv6地址"
      },
      "ipv6Port": {
        "type": "string",
        "pattern": "^\\[(?:(?:(?:[A-F0-9]{1,4}:){6}|(?=(?:[A-F0-9]{0,4}:){0,6}(?:[0-9]{1,3}\\.){3}[0-9]{1,3}(?![:.\\w]))(([0-9A-F]{1,4}:){0,5}|:)((:[0-9A-F]{1,4}){1,5}:|:)|::(?:[A-F0-9]{1,4}:){5})(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}|(?=(?:[A-F0-9]{0,4}:){0,7}[A-F0-9]{0,4}(?![:.\\w]))(([0-9A-F]{1,4}:){1,7}|:)((:[0-9A-F]{1,4}){1,7}|:)|(?:[A-F0-9]{1,4}:){7}:|:(:[A-F0-9]{1,4}){7})(?![:.\\w])\\]:(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5])$",
        "errorMessage": "无效的IPv6地址:端口"
      },
      "ipv6CIDR": {
        "type": "string",
        "pattern": "^(?:(?:(?:[A-F0-9]{1,4}:){6}|(?=(?:[A-F0-9]{0,4}:){0,6}(?:[0-9]{1,3}\\.){3}[0-9]{1,3}(?![:.\\w]))(([0-9A-F]{1,4}:){0,5}|:)((:[0-9A-F]{1,4}){1,5}:|:)|::(?:[A-F0-9]{1,4}:){5})(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}|(?=(?:[A-F0-9]{0,4}:){0,7}[A-F0-9]{0,4}(?![:.\\w]))(([0-9A-F]{1,4}:){1,7}|:)((:[0-9A-F]{1,4}){1,7}|:)|(?:[A-F0-9]{1,4}:){7}:|:(:[A-F0-9]{1,4}){7})(?![:.\\w])\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9])$",
        "errorMessage": "无效的IPv6网段"
      },
      "ip": {
        "oneOf": [
          {"$ref": "#/definitions/patterns/ipv4"},
          {"$ref": "#/definitions/patterns/ipv6"}
        ]
      },
      "ipPort": {
        "oneOf": [
          {"$ref": "#/definitions/patterns/ipv4Port"},
          {"$ref": "#/definitions/patterns/ipv6Port"}
        ]
      },
      "ipCIDR": {
        "oneOf": [
          {"$ref": "#/definitions/patterns/ipv4CIDR"},
          {"$ref": "#/definitions/patterns/ipv6CIDR"}
        ]
      },
      "server": {
        "oneOf": [
          {"$ref": "#/definitions/patterns/ipv4"},
          {"$ref": "#/definitions/patterns/ipv4Port"},
          {"$ref": "#/definitions/patterns/ipv6"},
          {"$ref": "#/definitions/patterns/ipv6Port"}
        ]
      },
      "domain": {
        "type": "string",
        "pattern": "^(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,}$",
        "errorMessage": "无效的域名"
      },
      "url": {
        "type": "string",
        "pattern": "^https?:\\/\\/([^\\s/$.?#].[^\\s]*)\\.[^\\s]{2,}(\\/[^\\s]*)?$",
        "errorMessage": "无效的URL"
      },
      "uuid": {
        "type": "string",
        "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89aAbB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$",
        "errorMessage": "无效的UUID"
      },
      "rule": {
        "anyOf": [
          {
            "pattern": "^DOMAIN((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^DOMAIN-SUFFIX((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^DOMAIN-KEYWORD((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^DOMAIN-REGEX((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {"pattern": "^GEOSITE((?:,[^,]+){2})$"},
          {
            "pattern": "^IP-CIDR((?:,[^,]+){2})(,no-resolve)?$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IP-CIDR6((?:,[^,]+){2})(,no-resolve)?$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IP-ASN((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^GEOIP((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^SRC-GEOIP((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^SCR-IP-ASN((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^SRC-IP-CIDR((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^SRC-IP-SUFFIX((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^DST-PORT((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^SRC-PORT((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IN-PORT((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IN-TYPE((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IN-USER((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^IN-NAME((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^PROCESS-PATH((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^PROCESS-NAME((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {"pattern": "^UID((?:,[^,]+){2})$", "errorMessage": "无效的路由规则"},
          {
            "pattern": "^NETWORK((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^DSCP((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^RULE-SET((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {"pattern": "^AND((?:,[^,]+){2})$", "errorMessage": "无效的路由规则"},
          {"pattern": "^OR((?:,[^,]+){2})$", "errorMessage": "无效的路由规则"},
          {"pattern": "^NOT((?:,[^,]+){2})$", "errorMessage": "无效的路由规则"},
          {
            "pattern": "^SUB-RULE((?:,[^,]+){2})$",
            "errorMessage": "无效的路由规则"
          },
          {
            "pattern": "^MATCH((?:,[^,]+){1})$",
            "errorMessage": "无效的路由规则"
          }
        ]
      }
    }
  },
  "properties": {
    "port": {
      "description": "HTTP(S) 代理服务器端口",
      "markdownDescription": "HTTP(S) 代理服务器端口`code`",
      "$ref": "#/definitions/types/ipv4CIDRArray"
    },
    "socks-port": {
      "description": "SOCKS 代理端口",
      "$ref": "#/definitions/patterns/port"
    },
    "mixed-port": {
      "description": "HTTP(S) 和 SOCKS 代理混合端口",
      "$ref": "#/definitions/patterns/port"
    },
    "redir-port": {
      "description": "透明代理端口，用于 Linux 和 MacOS",
      "$ref": "#/definitions/patterns/port"
    },
    "tproxy-port": {
      "description": "透明代理端口，用于 Linux (TProxy TCP 和 TProxy UDP)",
      "$ref": "#/definitions/patterns/port"
    },
    "allow-lan": {"description": "允许局域网连接", "type": "boolean"},
    "bind-address": {
      "description": "绑定 IP 地址，仅当 allow-lan 为 true 时生效,'*'表示所有地址",
      "type": "string",
      "default": "*"
    },
    "authentication": {
      "description": "http,socks入口的验证用户名,密码",
      "$ref": "#/definitions/types/stringArray"
    },
    "skip-auth-prefixes": {
      "description": "设置跳过验证的IP段",
      "$ref": "#/definitions/types/stringArray",
      "default": ["127.0.0.1/8", "::1/128"]
    },
    "lan-allowed-ips": {
      "description": "允许连接的 IP 地址段,仅当 allow-lan 为 true 时生效",
      "$ref": "#/definitions/types/stringArray",
      "default": ["0.0.0.0/0", "::/0"]
    },
    "find-process-mode": {
      "type": "string",
      "description": "进程匹配模式",
      "enum": ["always", "strict", "off"],
      "default": "strict"
    },
    "mode": {
      "type": "string",
      "description": "运行模式",
      "enum": ["rule", "global", "direct"],
      "default": "rule"
    },
    "geox-url": {
      "type": "object",
      "properties": {
        "geoip": {"type": "string", "description": "geoip下载url"},
        "geosite": {"type": "string", "description": "geosite下载url"},
        "mmdb": {"type": "string", "description": "mmdb下载url"}
      }
    },
    "geo-auto-update": {
      "type": "boolean",
      "description": "是否自动更新geodata",
      "default": false
    },
    "geo-update-interval": {
      "type": "integer",
      "description": "geodata自动更新间隔(单位：小时)",
      "default": 24
    },
    "geosite-matcher": {
      "type": "string",
      "description": "GeoSite匹配器",
      "enum": ["succinct", "mph"],
      "default": "succinct"
    },
    "log-level": {
      "type": "string",
      "description": "日志级别",
      "enum": ["silent", "error", "warning", "info", "debug"],
      "default": "debug"
    },
    "ipv6": {
      "type": "boolean",
      "description": "IPv6 总开关。关闭将阻断所有 IPv6 链接和屏蔽 DNS 请求 AAAA 记录",
      "default": true
    },
    "tls": {
      "type": "object",
      "properties": {
        "certificate": {
          "type": "string",
          "description": "tls证书(PEM 格式，或者 证书的路径)"
        },
        "private-key": {
          "type": "string",
          "description": "tls证书对应的私钥(PEM 格式，或者私钥路径)"
        },
        "custom-certifactes": {
          "description": "自定义tls证书(PEM 格式，或者 证书的路径)",
          "$ref": "#/definitions/types/stringArray"
        }
      }
    },
    "external-controller": {
      "type": "string",
      "description": "外部控制 (HTTP-API)监听地址"
    },
    "external-controller-tls": {
      "type": "string",
      "description": "外部控制 (HTTPS-API)监听地址"
    },
    "secret": {"type": "string", "description": "API访问Bearer Token"},
    "tcp-concurrent": {
      "type": "boolean",
      "description": "TCP并发连接所有 IP,并使用最快握手的TCP"
    },
    "external-ui": {"type": "string", "description": "外部UI界面目录"},
    "external-ui-name": {"type": "string", "description": "外部UI界面名字"},
    "external-ui-url": {"type": "string", "description": "外部UI界面下载地址"},
    "interface-name": {"type": "string", "description": "指定流量出口网卡"},
    "global-client-fingerprint": {
      "type": "string",
      "description": "全局 TLS 指纹(优先低于 proxy 中配置的 client-fingerprint),当前支持 VLESS/Vmess/trojan 的 TCP/grpc/WS/HTTP TLS传输",
      "enum": ["chrome", "firefox", "safari", "ios", "random", "none"]
    },
    "keep-alive-interval": {
      "type": "integer",
      "description": "TCP Keep Alive 间隔(控制发出TCP Keep Alive 包的间隔,减少移动设备耗电问题的临时措施)",
      "default": 15
    },
    "routing-mark": {
      "type": "string",
      "description": "配置策略组出站时附带路由标记(仅用于 Linux)",
      "default": 15
    },
    "experimental": {
      "type": "object",
      "description": "实验性内容",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "quic-go-disable-gso": {
          "type": "boolean",
          "description": "quic-go禁用GSO(可能会使Linux平台性能下降)"
        },
        "quic-go-disable-ecn": {
          "type": "boolean",
          "description": "quic-go禁用ECN"
        },
        "dialer-ip4p-convert": {
          "type": "boolean",
          "description": "启用IP4P地址转换"
        }
      }
    },
    "hosts": {
      "description": "自定义hosts(仅支持配置单个IP)",
      "$ref": "#/definitions/types/stringArray"
    },
    "profile": {
      "type": "object",
      "description": "缓存",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "store-selected": {
          "type": "boolean",
          "description": "缓存策略组的选择,以供下次启动时使用",
          "default": true
        },
        "store-fake-ip": {
          "type": "boolean",
          "description": "缓存fakeip映射表,域名再次发生连接时,使用原有映射地址",
          "default": true
        }
      }
    },
    "tun": {
      "type": "object",
      "description": "TUN配置",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "enable": {
          "type": "boolean",
          "description": "启用TUN模式",
          "default": false
        },
        "stack": {
          "type": "string",
          "description": "TUN模式堆栈",
          "enum": ["system", "gvisor", "mixed"],
          "default": "system"
        },
        "dns-hijack": {
          "description": "DNS劫持列表",
          "$ref": "#/definitions/types/stringArray"
        },
        "auto-detect-interface": {
          "type": "boolean",
          "description": "自动识别出口网卡",
          "default": true
        },
        "auto-route": {
          "type": "boolean",
          "description": "自动配置路由表",
          "default": true
        },
        "mtu": {
          "type": "integer",
          "description": "最大传输单元",
          "default": 9000
        },
        "gso": {
          "type": "boolean",
          "description": "启用通用分段卸载(仅支持Linux)",
          "default": false
        },
        "gso-max-size": {
          "type": "integer",
          "description": "通用分段卸载包的最大大小",
          "default": 65536
        },
        "strict-route": {
          "type": "boolean",
          "description": "将所有连接路由到TUN来防止泄漏,但你的设备将无法其他设备被访问",
          "default": true
        },
        "inet4-route-address": {
          "description": "启用auto-route时,指定使用自定义路由而不是默认路由的IPV4地址",
          "$ref": "#/definitions/types/stringArray"
        },
        "inet6-route-address": {
          "description": "启用auto-route时,指定使用自定义路由而不是默认路由的IPV5地址",
          "$ref": "#/definitions/types/stringArray"
        },
        "endpoint-independent-nat": {
          "type": "boolean",
          "description": "启用独立于端点的 NAT",
          "default": false
        },
        "include-interface": {
          "type": "string",
          "description": "限制被路由的接口(与exclude-interface冲突)"
        },
        "exclude-interface": {
          "type": "string",
          "description": "排除被路由的接口(与include-interface冲突)"
        },
        "include-uid": {
          "description": "包含被路由的Linux用户,使其被Tun路由流量(需要启用auto-route)",
          "$ref": "#/definitions/types/stringArray"
        },
        "include-uid-range": {
          "description": "限制被路由的的Linux用户范围",
          "$ref": "#/definitions/types/stringArray"
        },
        "exclude-uid": {
          "description": "排除被路由的Linux用户,使其不被Tun路由流量(需要启用auto-route)",
          "$ref": "#/definitions/types/stringArray"
        },
        "exclude-uid-range": {
          "description": "排除被路由的的Linux用户范围",
          "$ref": "#/definitions/types/stringArray"
        },
        "include-android-user": {
          "description": "限制被路由的Android用户",
          "$ref": "#/definitions/types/stringArray"
        },
        "include-package": {
          "description": "限制被路由的Android应用包名",
          "$ref": "#/definitions/types/stringArray"
        },
        "exclude-package": {
          "description": "排除被路由的Android应用包名",
          "$ref": "#/definitions/types/stringArray"
        }
      }
    },
    "ebpf": {
      "type": "object",
      "description": "eBPF配置",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "auto-redir": {
          "description": "自动重定向,redirect模式(仅支持TCP)",
          "$ref": "#/definitions/types/stringArray"
        },
        "redirect-to-tun": {
          "type": "boolean",
          "description": "重定向到TUN(UDP+TCP使用该功能请勿启用)"
        },
        "auto-route": {
          "description": "自动路由",
          "$ref": "#/definitions/types/stringArray"
        }
      }
    },
    "sniffer": {
      "type": "object",
      "description": "域名嗅探",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "enable": {
          "type": "boolean",
          "description": "启用域名嗅探",
          "default": false
        },
        "force-dns-mapping": {
          "type": "boolean",
          "description": "对redir-host类型识别的流量进行强制嗅探",
          "default": false
        },
        "parse-pure-ip": {
          "type": "boolean",
          "description": "对所有未获取到域名的流量进行强制嗅探",
          "default": false
        },
        "override-destination": {
          "type": "boolean",
          "description": "是否使用嗅探结果作为实际访问(全局配置,优先级低于sniffer.sniff中的配置)",
          "default": true
        },
        "sniff": {
          "type": "object",
          "description": "域名嗅探配置",
          "properties": {
            "QUIC": {
              "type": "object",
              "properties": {
                "ports": {
                  "type": "array",
                  "description": "嗅探端口列表",
                  "items": {"type": "integer", "minimum": 0, "maximum": 65535},
                  "default": [443]
                }
              }
            },
            "TLS": {
              "type": "object",
              "properties": {
                "ports": {
                  "type": "array",
                  "description": "嗅探端口列表",
                  "items": {"type": "integer", "minimum": 0, "maximum": 65535},
                  "default": [443]
                }
              }
            },
            "HTTP": {
              "type": "object",
              "properties": {
                "ports": {
                  "type": "array",
                  "description": "嗅探端口列表",
                  "items": {"type": "integer", "minimum": 0, "maximum": 65535},
                  "default": [80]
                },
                "override-destination": {
                  "type": "boolean",
                  "description": "可覆盖",
                  "default": true
                }
              }
            }
          }
        },
        "force-domain": {
          "description": "需要强制嗅探的域名(默认情况下只对IP进行嗅探)",
          "$ref": "#/definitions/types/stringArray"
        },
        "skip-domain": {
          "description": "需要跳过嗅探的域名",
          "$ref": "#/definitions/types/stringArray"
        }
      }
    },
    "tunnels": {
      "type": "array",
      "items": {
        "anyOf": [
          {"type": "string", "pattern": "^.+,.+,.+,.+$"},
          {
            "type": "object",
            "properties": {
              "network": {
                "type": "array",
                "items": {"type": "string", "enum": ["tcp", "udp"]}
              },
              "address": {"type": "string"},
              "target": {"type": "string"},
              "proxy": {"type": "string"}
            }
          }
        ]
      }
    },
    "dns": {
      "type": "object",
      "description": "DNS配置",
      "definitions": {
        "types": {"$ref": "#/definitions/types"},
        "patterns": {"$ref": "#/definitions/patterns"}
      },
      "properties": {
        "enable": {
          "type": "boolean",
          "title": "启用DNS",
          "description": "关闭将使用系统DNS",
          "markdownDescription": "关闭将使用系统DNS",
          "default": false
        },
        "prefer-h3": {
          "type": "boolean",
          "title": "启用DoH的HTTP/3支持",
          "description": "启用DoH的HTTP/3支持",
          "markdownDescription": "启用DoH的`HTTP/3`支持",
          "default": false
        },
        "ipv6": {
          "type": "boolean",
          "title": "是否解析IPV6",
          "description": "如为false,则回应内容为AAAA的空解析",
          "markdownDescription": "如为false,则回应内容为AAAA的空解析",
          "default": false
        },
        "ipv6-timeout": {
          "type": "integer",
          "title": "解析IPV6超时时间",
          "description": "单位: ms",
          "markdownDescription": "单位: ms",
          "default": 100
        },
        "use-hosts": {
          "type": "boolean",
          "title": "查询系统hosts文件",
          "description": "查询系统hosts文件",
          "markdownDescription": "查询系统`hosts`文件",
          "default": true
        },
        "nameserver": {
          "$ref": "#/definitions/types/stringArray",
          "title": "默认域名解析服务器",
          "description": "支持UDP,TCP,DoT,DoH,DoQ",
          "markdownDescription": "支持`UDP`,`TCP`,`DoT`,`DoH`,`DoQ`",
          "default": ["https://doh.pub/dns-query", "tls://223.5.5.5:853"]
        },
        "fallback": {
          "$ref": "#/definitions/types/stringArray",
          "title": "备用域名解析服务器",
          "description": "一般情况下使用境外DNS服务器,保证结果可信",
          "markdownDescription": "一般情况下使用境外DNS服务器,保证结果可信"
        },
        "fallback-filter": {
          "type": "object",
          "title": "备用域名解析服务器过滤",
          "description": "满足条件的将采用fallback的解析结果,或只采用fallback解析结果",
          "markdownDescription": "满足条件的将采用`fallback`的解析结果,或只采用`fallback`解析结果",
          "properties": {
            "geoip": {
              "type": "boolean",
              "title": "启用fallback-filter",
              "description": "启用fallback-filter",
              "markdownDescription": "启用`fallback-filter`",
              "default": true
            },
            "geoip-code": {
              "type": "string",
              "title": "启用fallback-filter",
              "description": "除geoip-code配置的国家IP外,其他IP结果会被视为污染。geoip-code对应国家的结果会直接采用,其余结果将采用fallback的解析结果",
              "markdownDescription": "除`geoip-code`配置的国家IP外,其他IP结果会被视为污染。`geoip-code`对应国家的结果会直接采用,其余结果将采用`fallback`的解析结果",
              "default": "CN"
            },
            "ipcidr": {
              "$ref": "#/definitions/types/ipCIDRArray",
              "title": "DNS污染网段列表",
              "description": "这些网段的结果会被视为污染,将采用fallback的解析结果",
              "markdownDescription": "这些网段的结果会被视为污染,将采用`fallback`的解析结果"
            },
            "domain": {
              "$ref": "#/definitions/types/stringArray",
              "title": "DNS污染域名列表",
              "description": "这些域名的结果会被视为污染,将采用fallback的解析结果",
              "markdownDescription": "这些域名的结果会被视为污染,将采用`fallback`的解析结果"
            },
            "geosite": {
              "$ref": "#/definitions/types/stringArray",
              "title": "DNS污染geosite列表",
              "description": "这些geosite的结果会被视为污染,将采用fallback的解析结果",
              "markdownDescription": "这些geosite的结果会被视为污染,将采用`fallback`的解析结果"
            }
          }
        },
        "listen": {
          "$ref": "#/definitions/patterns/ipPort",
          "title": "DNS服务器监听地址",
          "description": "DNS服务器监听地址",
          "markdownDescription": "DNS服务器监听地址",
          "default": "127.0.0.1:53"
        },
        "enhanced-mode": {
          "enum": ["normal", "fake-ip", "redir-host"],
          "enumDescriptions": ["普通模式", "fake-ip模式", "redir-host模式"],
          "title": "增强模式",
          "description": "DNS处理模式",
          "markdownDescription": "DNS处理模式",
          "default": "fake-ip"
        },
        "fake-ip-range": {
          "$ref": "#/definitions/patterns/ipCIDR",
          "title": "fake-ip的预留映射地址段",
          "description": "tun模式的网卡默认IP也使用此值作为参考",
          "markdownDescription": "tun模式的网卡默认IP也使用此值作为参考",
          "default": "198.18.0.1/16"
        },
        "fake-ip-filter": {
          "$ref": "#/definitions/types/stringArray",
          "title": "fakeip过滤",
          "description": "不使用fake-ip的地址范围",
          "markdownDescription": "不使用`fake-ip`的地址范围",
          "default": [
            "dns.msftnsci.com",
            "www.msftnsci.com",
            "www.msftconnecttest.com"
          ]
        },
        "default-nameserver": {
          "$ref": "#/definitions/types/serverArray",
          "title": "元域名解析服务器",
          "description": "解析nameserver,fallback以及其他DNS服务器配置的DNS服务器(只能使用纯IP地址,支持加密DNS)",
          "markdownDescription": "解析`nameserver`,`fallback`以及其他DNS服务器配置的DNS服务器(只能使用纯IP地址,支持加密DNS)",
          "default": ["114.114.114.114", "223.5.5.5", "8.8.8.8", "1.0.0.1"]
        },
        "cache-algorithm": {
          "enum": ["lru", "arc"],
          "enumDescriptions": ["最近最少使用", "自适应替换缓存"],
          "title": "缓存算法",
          "description": "lru: Least Recently Used, arc: Adaptive Replacement Cache",
          "markdownDescription": "`lru`: Least Recently Used, `arc`: Adaptive Replacement Cache",
          "default": "lru"
        },
        "nameserver-policy": {
          "type": "object",
          "additionalProperties": {"$ref": "#/definitions/types/stringArray"},
          "title": "DNS解析服务器策略",
          "description": "指定地址使用特定DNS解析服务器",
          "markdownDescription": "指定地址使用特定DNS解析服务器"
        },
        "proxy-server-nameserver": {
          "$ref": "#/definitions/types/stringArray",
          "title": "代理节点DNS解析服务器",
          "description": "用于解析代理节点的域名",
          "markdownDescription": "用于解析代理节点的域名"
        }
      }
    },
    "proxies": {
      "type": "array",
      "description": "代理节点",
      "items": {
        "anyOf": [
          {
            "type": "object",
            "required": ["name", "type", "server", "port"],
            "additionalProperties": true,
            "properties": {
              "name": {"type": "string"},
              "type": {"title": "socks5", "const": "socks5"},
              "server": {"type": "string"},
              "port": {"type": "integer", "minimum": 0, "maximum": 65535}
            }
          },
          {
            "type": "object",
            "required": ["name", "type", "server", "port"],
            "additionalProperties": true,
            "properties": {
              "name": {"type": "string"},
              "type": {"title": "http", "const": "http"},
              "server": {"type": "string"},
              "port": {"type": "integer", "minimum": 0, "maximum": 65535}
            }
          },
          {
            "type": "object",
            "required": ["name", "type", "server", "port"],
            "additionalProperties": true,
            "properties": {
              "name": {"type": "string"},
              "type": {"title": "snell", "const": "snell"},
              "server": {"type": "string"},
              "port": {"type": "integer", "minimum": 0, "maximum": 65535}
            }
          },
          {
            "type": "object",
            "required": [
              "name",
              "type",
              "server",
              "port",
              "cipher",
              "password"
            ],
            "additionalProperties": true,
            "properties": {
              "name": {"type": "string"},
              "type": {"title": "ss", "const": "ss"},
              "server": {"type": "string"},
              "port": {"type": "integer", "minimum": 0, "maximum": 65535},
              "cipher": {
                "type": "string",
                "enum": [
                  "auto",
                  "aes-128-gcm",
                  "aes-192-gcm",
                  "aes-256-gcm",
                  "aes-128-cfb",
                  "aes-192-cfb",
                  "aes-256-cfb",
                  "aes-128-ctr",
                  "aes-192-ctr",
                  "aes-256-ctr",
                  "rc4-md5",
                  "chacha20-ietf",
                  "xchacha20",
                  "chacha20-ietf-poly1305",
                  "xchacha20-ietf-poly1305",
                  "2022-blake3-aes-128-gcm",
                  "2022-blake3-aes-256-gcm",
                  "2022-blake3-chacha20-poly1305"
                ]
              },
              "udp": {"type": "boolean", "default": true},
              "udp-over-tcp": {"type": "boolean", "default": false},
              "ip-version": {
                "type": "string",
                "enum": ["dual", "ipv4", "ipv6", "ipv4-prefer", "ipv6-prefer"],
                "default": "dual"
              },
              "plugin": {
                "type": "string",
                "enum": ["obfs", "v2ray-plugin", "shadow-tls", "restls"]
              },
              "plugin-opts": {"type": "object", "additionalProperties": true},
              "smux": {
                "type": "object",
                "properties": {
                  "enabled": {"type": "boolean", "default": false},
                  "protocol": {
                    "type": "string",
                    "enum": ["smux", "yamux", "h2mux"],
                    "default": "smux"
                  },
                  "max-connections": {"type": "integer", "default": 4},
                  "min-streams": {"type": "integer", "default": 4},
                  "max-streams": {"type": "integer", "default": 0},
                  "padding": {"type": "boolean", "default": false},
                  "statistic": {"type": "boolean", "default": false},
                  "only-tcp": {"type": "boolean", "default": false}
                }
              }
            }
          }
        ]
      }
    }
  }
}
